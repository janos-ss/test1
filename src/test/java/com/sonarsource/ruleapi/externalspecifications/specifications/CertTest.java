/*
 * Copyright (C) 2014-2016 SonarSource SA
 * All rights reserved
 * mailto:contact AT sonarsource DOT com
 */
package com.sonarsource.ruleapi.externalspecifications.specifications;

import com.sonarsource.ruleapi.domain.CodingStandardRuleCoverage;
import com.sonarsource.ruleapi.domain.Rule;
import com.sonarsource.ruleapi.services.RuleManager;
import com.sonarsource.ruleapi.utilities.Language;
import org.json.simple.JSONArray;
import org.json.simple.parser.JSONParser;
import org.json.simple.parser.ParseException;
import org.junit.Test;

import java.util.ArrayList;
import java.util.List;

import static org.fest.assertions.Assertions.assertThat;


public class CertTest {

  Cert cert = new Cert();

  @Test
  public void testBadFormatNoUpdates() {

    Rule rule = new Rule("");

    List<String> updates = new ArrayList<>();

    assertThat(cert.doesReferenceNeedUpdating("ABC01-Q",updates, rule.getKey())).isFalse();
    assertThat(updates).hasSize(1);

    assertThat(cert.doesReferenceNeedUpdating("ABC01-CPP",updates, rule.getKey())).isFalse();
    assertThat(updates).hasSize(2);

    assertThat(cert.doesReferenceNeedUpdating("413",updates, rule.getKey())).isFalse();
    assertThat(updates).hasSize(3);

    assertThat(cert.doesReferenceNeedUpdating("ABC43-Java",updates, rule.getKey())).isFalse();
    assertThat(updates).hasSize(4);

  }

  @Test
  public void testGetCleanupReportBody(){

    Rule rule = new Rule("");
    List<Rule> list = new ArrayList<>();
    list.add(rule);

    String report = cert.getCleanupReportBody(list);
    assertThat(report).isEqualTo("");

    rule.setReferences("CERT, ASDF01-J");
    report = cert.getCleanupReportBody(list);
    assertThat(report).isEqualTo("Not found: null : CERT, ASDF01-J\n" +
            "https://www.securecoding.cert.org/confluence/rest/api/content?title=ASDF01-J\n");
  }

  @Test
  public void testGetReportBody(){

    Cert freshCert = new Cert();

    // pre-empty fetch of rules from CERT cite
    Cert.CertRule certRule = new Cert.CertRule("PRE30-C.", "test title", "http://boo.com", new ArrayList<String>());
    Cert.CertRule certRule2 = new Cert.CertRule("MSC01-C.", "Miscellaney", "http://misc.com", new ArrayList<String>());
    Cert.CertRule[] certRules = {certRule, certRule2};

    freshCert.populateRulesCoverageMap();

    CodingStandardRuleCoverage csrc = new CodingStandardRuleCoverage();
    csrc.setCodingStandardRuleId("PRE30-C.");
    freshCert.getRulesCoverage().put("PRE30-C.", csrc);

    csrc = new CodingStandardRuleCoverage();
    csrc.setCodingStandardRuleId("MSC01-C.");
    freshCert.getRulesCoverage().put("MSC01-C.", csrc);

    Rule rule = new Rule("");
    rule.setKey("ruleKey");
    rule.getCert().add("PRE30-C.");
    rule.setTitle("Rule for PRE30-C.");
    freshCert.setCodingStandardRuleCoverageImplemented(rule.getCert(), rule);

    Rule rule2 = new Rule("");
    rule2.setKey("rule2");
    rule2.getCert().add("MSC01-C.");
    rule2.setTitle("Rule for MSC01-C.");
    freshCert.setCodingStandardRuleCoverageSpecifiedBy(rule2, rule2.getCert());


    assertThat(freshCert.generateReport(RuleManager.SONARQUBE_COM)).isNull();
    assertThat(freshCert.getReportBody(RuleManager.SONARQUBE_COM, certRules)).isNull();


    freshCert.setLanguage(Language.C);

    String result = freshCert.getReportBody(RuleManager.SONARQUBE_COM, certRules);
    assertThat(result).contains(rule.getTitle()).doesNotContain(rule2.getTitle());
  }

  @Test
  public void testGenerateReportNullLanguage() {
    Cert freshCert = new Cert();

    Rule rule = new Rule("");
    List<String> ids = new ArrayList<>();
    ids.add("ASD01-J.");
    ids.add("ASD02-J.");

    freshCert.setCodingStandardRuleCoverageImplemented(ids, rule);

    String result = freshCert.generateReport(RuleManager.SONARQUBE_COM);
    assertThat(result).isNull();
  }

  @Test
  public void testGetCodingStandardRules(){
    Cert freshCert = new Cert();

    assertThat(freshCert.getCodingStandardRules()).isEmpty();
  }

  @Test
  public void testLanguageSetting(){
    Cert freshCert = new Cert();
    freshCert.setLanguage(Language.ABAP);

    assertThat(freshCert.getLanguage()).isNull();

    freshCert.setLanguage(Language.CPP);
    assertThat(freshCert.getLanguage()).isEqualTo(Language.CPP);

    freshCert.setLanguage(Language.JAVA);
    assertThat(freshCert.getLanguage()).isEqualTo(Language.JAVA);

    freshCert.setLanguage(Language.C);
    assertThat(freshCert.getLanguage()).isEqualTo(Language.C);

  }

  @Test
  public void testGetSpecificReferences(){
    String references = "<ul>" +
            "<li><a href='http://blah.com>CERT ASD01-F.</a> - bibbity bobbity boo</li>\n" +
            "</ul>\n" +
            "<h3>See also</h3>\n" +
            "<ul>\n" +
            "<li>Foo</li>\n" +
            "</ul>\n";

    Rule rule = new Rule("");
    rule.setReferences(references);

    List<String> refs = cert.getSpecificReferences(rule);
    assertThat(refs.size()).isEqualTo(1);
  }

  @Test
  public void testExtractRulesFromChildPages() {
    Cert.CertType cppType = new Cert.CertType(Language.CPP, new String[]{"146440541"});

    String baseUrl = "http://foo.com";
    List<String> ids = new ArrayList<>();

    String dudResults = "[{\"id\":\"35979419\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 00. Input Validation and Data Sanitization (IDS)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/35979419/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=35979419\",\"tinyui\":\"/x/mwAlAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/35979419\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/35979419/child\",\"history\":\"/rest/api/content/35979419/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/35979419/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"19530101\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 01. Declarations and Initialization (DCL)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"dcl\",\"id\":\"41287702\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/19530101/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=19530101\",\"tinyui\":\"/x/dQEqAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/19530101\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/19530101/child\",\"history\":\"/rest/api/content/19530101/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/19530101/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"18579812\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 02. Expressions (EXP)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"exp\",\"id\":\"41287701\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18579812/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=18579812\",\"tinyui\":\"/x/ZIEbAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18579812\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/18579812/child\",\"history\":\"/rest/api/content/18579812/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/18579812/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"60752466\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 03. Numeric Types and Operations (NUM)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"num\",\"id\":\"60882947\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/60752466/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=60752466\",\"tinyui\":\"/x/UgKfAw\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/60752466\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/60752466/child\",\"history\":\"/rest/api/content/60752466/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/60752466/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"151388175\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 04. Characters and Strings (STR)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"str\",\"id\":\"41287704\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388175/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=151388175\",\"tinyui\":\"/x/DwAGCQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388175\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/151388175/child\",\"history\":\"/rest/api/content/151388175/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/151388175/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"6029486\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 05. Object Orientation (OBJ)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"obj\",\"id\":\"41549836\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/6029486/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=6029486\",\"tinyui\":\"/x/rgBc\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/6029486\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/6029486/child\",\"history\":\"/rest/api/content/6029486/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/6029486/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"18580918\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 06. Methods (MET)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"met\",\"id\":\"59080714\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18580918/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=18580918\",\"tinyui\":\"/x/toUbAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18580918\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/18580918/child\",\"history\":\"/rest/api/content/18580918/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/18580918/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"18581047\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 07. Exceptional Behavior (ERR)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"err\",\"id\":\"41287707\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18581047/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=18581047\",\"tinyui\":\"/x/N4YbAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18581047\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/18581047/child\",\"history\":\"/rest/api/content/18581047/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/18581047/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"47677814\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 08. Visibility and Atomicity (VNA)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"vna\",\"id\":\"59080709\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677814/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=47677814\",\"tinyui\":\"/x/doHXAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677814\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/47677814/child\",\"history\":\"/rest/api/content/47677814/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/47677814/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"18581044\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 09. Locking (LCK)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"review1\",\"id\":\"53772289\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"lck\",\"id\":\"59080710\"}],\"start\":0,\"limit\":200,\"size\":4,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18581044/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=18581044\",\"tinyui\":\"/x/NIYbAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18581044\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/18581044/child\",\"history\":\"/rest/api/content/18581044/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/18581044/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"47677925\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 10. Thread APIs (THI)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"thi\",\"id\":\"59080711\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677925/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=47677925\",\"tinyui\":\"/x/5YHXAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677925\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/47677925/child\",\"history\":\"/rest/api/content/47677925/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/47677925/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"47677929\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 11. Thread Pools (TPS)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"tps\",\"id\":\"59080712\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677929/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=47677929\",\"tinyui\":\"/x/6YHXAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677929\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/47677929/child\",\"history\":\"/rest/api/content/47677929/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/47677929/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"47677927\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 12. Thread-Safety Miscellaneous (TSM)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"tsm\",\"id\":\"59080713\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677927/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=47677927\",\"tinyui\":\"/x/54HXAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/47677927\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/47677927/child\",\"history\":\"/rest/api/content/47677927/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/47677927/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"6029489\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 13. Input Output (FIO)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"fio038j\",\"id\":\"23953416\"},{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"fio\",\"id\":\"10944513\"}],\"start\":0,\"limit\":200,\"size\":4,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/6029489/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=6029489\",\"tinyui\":\"/x/sQBc\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/6029489\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/6029489/child\",\"history\":\"/rest/api/content/6029489/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/6029489/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"27492407\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 14. Serialization (SER)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"ser\",\"id\":\"59080707\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/27492407/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=27492407\",\"tinyui\":\"/x/N4CjAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/27492407\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/27492407/child\",\"history\":\"/rest/api/content/27492407/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/27492407/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"4254\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 15. Platform Security (SEC)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"sec\",\"id\":\"59080705\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/4254/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=4254\",\"tinyui\":\"/x/nh\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/4254\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/4254/child\",\"history\":\"/rest/api/content/4254/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/4254/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"33128636\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 16. Runtime Environment (ENV)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"env\",\"id\":\"11436033\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/33128636/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=33128636\",\"tinyui\":\"/x/vID5AQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/33128636\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/33128636/child\",\"history\":\"/rest/api/content/33128636/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/33128636/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"121930001\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 17. Java Native Interface (JNI)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"jni\",\"id\":\"122257411\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/121930001/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=121930001\",\"tinyui\":\"/x/EYFEBw\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/121930001\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/121930001/child\",\"history\":\"/rest/api/content/121930001/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/121930001/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"18579861\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 49. Miscellaneous (MSC)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"section\",\"id\":\"41287698\"},{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"},{\"prefix\":\"global\",\"name\":\"msc\",\"id\":\"41287708\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18579861/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=18579861\",\"tinyui\":\"/x/lYEbAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/18579861\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/18579861/child\",\"history\":\"/rest/api/content/18579861/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/18579861/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"161218645\",\"type\":\"page\",\"status\":\"current\",\"title\":\"Rule 50. Android (DRD)\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"rule-list\",\"id\":\"156663812\"}],\"start\":0,\"limit\":200,\"size\":1,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/161218645/label\"}}},\"extensions\":{\"position\":\"none\"},\"_links\":{\"webui\":\"/pages/viewpage.action?pageId=161218645\",\"tinyui\":\"/x/VQCcCQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/161218645\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/161218645/child\",\"history\":\"/rest/api/content/161218645/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/161218645/descendant\",\"space\":\"/rest/api/space/java\"}}]";
    String goodResults = "[{\"id\":\"34669118\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS00-J. Prevent SQL injection\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"analyzable\",\"id\":\"36175873\"},{\"prefix\":\"global\",\"name\":\"cwe-79\",\"id\":\"42303499\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"dos\",\"id\":\"65601538\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"android-implementation-detail-java\",\"id\":\"129499137\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"}],\"start\":0,\"limit\":200,\"size\":8,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/34669118/label\"}}},\"extensions\":{\"position\":0},\"_links\":{\"webui\":\"/display/java/IDS00-J.+Prevent+SQL+injection\",\"tinyui\":\"/x/PgIRAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/34669118\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/34669118/child\",\"history\":\"/rest/api/content/34669118/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/34669118/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"34930775\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS01-J. Normalize strings before validating them\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"analyzable\",\"id\":\"36175873\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"normative\",\"id\":\"62160898\"},{\"prefix\":\"global\",\"name\":\"tech-edit-done\",\"id\":\"43909121\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"android-implementation-detail-java\",\"id\":\"129499137\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":7,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/34930775/label\"}}},\"extensions\":{\"position\":1},\"_links\":{\"webui\":\"/display/java/IDS01-J.+Normalize+strings+before+validating+them\",\"tinyui\":\"/x/VwAVAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/34930775\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/34930775/child\",\"history\":\"/rest/api/content/34930775/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/34930775/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"149192709\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS02-J. Canonicalize path names before validating them\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"deprecated\",\"id\":\"109281281\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/149192709/label\"}}},\"extensions\":{\"position\":2},\"_links\":{\"webui\":\"/display/java/IDS02-J.+Canonicalize+path+names+before+validating+them\",\"tinyui\":\"/x/BYDkC\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/149192709\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/149192709/child\",\"history\":\"/rest/api/content/149192709/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/149192709/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"35487776\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS03-J. Do not log unsanitized user input\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"analyzable\",\"id\":\"36175873\"},{\"prefix\":\"global\",\"name\":\"sensitive\",\"id\":\"63012866\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"logging\",\"id\":\"148176899\"},{\"prefix\":\"global\",\"name\":\"injection\",\"id\":\"148176900\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"android-applicable\",\"id\":\"162201606\"}],\"start\":0,\"limit\":200,\"size\":9,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/35487776/label\"}}},\"extensions\":{\"position\":3},\"_links\":{\"webui\":\"/display/java/IDS03-J.+Do+not+log+unsanitized+user+input\",\"tinyui\":\"/x/IIAdAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/35487776\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/35487776/child\",\"history\":\"/rest/api/content/35487776/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/35487776/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"62849500\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS04-J. Safely extract files from ZipInputStream\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"},{\"prefix\":\"global\",\"name\":\"resource-exhaustion\",\"id\":\"63897601\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"android-implementation-detail-java\",\"id\":\"129499137\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":6,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/62849500/label\"}}},\"extensions\":{\"position\":4},\"_links\":{\"webui\":\"/display/java/IDS04-J.+Safely+extract+files+from+ZipInputStream\",\"tinyui\":\"/x/3AG-Aw\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/62849500\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/62849500/child\",\"history\":\"/rest/api/content/62849500/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/62849500/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"149192848\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS05-J. Use a safe subset of ASCII for file and path names\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"deprecated\",\"id\":\"109281281\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/149192848/label\"}}},\"extensions\":{\"position\":5},\"_links\":{\"webui\":\"/display/java/IDS05-J.+Use+a+safe+subset+of+ASCII+for+file+and+path+names\",\"tinyui\":\"/x/kIDkC\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/149192848\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/149192848/child\",\"history\":\"/rest/api/content/149192848/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/149192848/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"19235145\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS06-J. Exclude unsanitized user input from format strings\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"analyzable\",\"id\":\"36175873\"},{\"prefix\":\"global\",\"name\":\"malicious\",\"id\":\"63012867\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"},{\"prefix\":\"global\",\"name\":\"dos\",\"id\":\"65601538\"},{\"prefix\":\"global\",\"name\":\"cwe-134\",\"id\":\"68550660\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"android-applicable\",\"id\":\"162201606\"}],\"start\":0,\"limit\":200,\"size\":9,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/19235145/label\"}}},\"extensions\":{\"position\":6},\"_links\":{\"webui\":\"/display/java/IDS06-J.+Exclude+unsanitized+user+input+from+format+strings\",\"tinyui\":\"/x/SYElAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/19235145\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/19235145/child\",\"history\":\"/rest/api/content/19235145/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/19235145/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"28442971\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS07-J. Sanitize untrusted data passed to the Runtime.exec() method\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"cwe-78\",\"id\":\"41287684\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"android-implementation-detail-java\",\"id\":\"129499137\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":5,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/28442971/label\"}}},\"extensions\":{\"position\":7},\"_links\":{\"webui\":\"/display/java/IDS07-J.+Sanitize+untrusted+data+passed+to+the+Runtime.exec%28%29+method\",\"tinyui\":\"/x/WwGyAQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/28442971\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/28442971/child\",\"history\":\"/rest/api/content/28442971/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/28442971/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"42729936\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS08-J. Sanitize untrusted data included in a regular expression\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"incomplete\",\"id\":\"3\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"},{\"prefix\":\"global\",\"name\":\"dos\",\"id\":\"65601538\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"android-applicable\",\"id\":\"162201606\"}],\"start\":0,\"limit\":200,\"size\":7,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/42729936/label\"}}},\"extensions\":{\"position\":8},\"_links\":{\"webui\":\"/display/java/IDS08-J.+Sanitize+untrusted+data+included+in+a+regular+expression\",\"tinyui\":\"/x/0AGMAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/42729936\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/42729936/child\",\"history\":\"/rest/api/content/42729936/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/42729936/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"151388187\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS09-J. Specify an appropriate locale when comparing locale-dependent data\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"deprecated\",\"id\":\"109281281\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388187/label\"}}},\"extensions\":{\"position\":9},\"_links\":{\"webui\":\"/display/java/IDS09-J.+Specify+an+appropriate+locale+when+comparing+locale-dependent+data\",\"tinyui\":\"/x/GwAGCQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388187\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/151388187/child\",\"history\":\"/rest/api/content/151388187/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/151388187/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"151388184\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS10-J. Don't form strings containing partial characters\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"deprecated\",\"id\":\"109281281\"}],\"start\":0,\"limit\":200,\"size\":3,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388184/label\"}}},\"extensions\":{\"position\":10},\"_links\":{\"webui\":\"/display/java/IDS10-J.+Don%27t+form+strings+containing+partial+characters\",\"tinyui\":\"/x/GAAGCQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388184\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/151388184/child\",\"history\":\"/rest/api/content/151388184/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/151388184/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"34930790\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS11-J. Perform any string modifications before validation\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"analyzable\",\"id\":\"36175873\"},{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"},{\"prefix\":\"global\",\"name\":\"android\",\"id\":\"87883779\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"},{\"prefix\":\"global\",\"name\":\"android-applicable\",\"id\":\"162201606\"}],\"start\":0,\"limit\":200,\"size\":6,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/34930790/label\"}}},\"extensions\":{\"position\":11},\"_links\":{\"webui\":\"/display/java/IDS11-J.+Perform+any+string+modifications+before+validation\",\"tinyui\":\"/x/ZgAVAg\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/34930790\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/34930790/child\",\"history\":\"/rest/api/content/34930790/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/34930790/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"151388196\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS13-J. Use compatible character encodings on both sides of file or network IO\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":2,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388196/label\"}}},\"extensions\":{\"position\":12},\"_links\":{\"webui\":\"/display/java/IDS13-J.+Use+compatible+character+encodings+on+both+sides+of+file+or+network+IO\",\"tinyui\":\"/x/JAAGCQ\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/151388196\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/151388196/child\",\"history\":\"/rest/api/content/151388196/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/151388196/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"139755530\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS14-J. Do not trust the contents of hidden form fields\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"},{\"prefix\":\"global\",\"name\":\"incomplete\",\"id\":\"3\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":4,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/139755530/label\"}}},\"extensions\":{\"position\":13},\"_links\":{\"webui\":\"/display/java/IDS14-J.+Do+not+trust+the+contents+of+hidden+form+fields\",\"tinyui\":\"/x/CoBUC\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/139755530\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/139755530/child\",\"history\":\"/rest/api/content/139755530/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/139755530/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"139755535\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS15-J. Do not allow sensitive information to leak outside a trust boundary\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"draft\",\"id\":\"63012871\"},{\"prefix\":\"global\",\"name\":\"incomplete\",\"id\":\"3\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":4,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/139755535/label\"}}},\"extensions\":{\"position\":14},\"_links\":{\"webui\":\"/display/java/IDS15-J.+Do+not+allow+sensitive+information+to+leak+outside+a+trust+boundary\",\"tinyui\":\"/x/D4BUC\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/139755535\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/139755535/child\",\"history\":\"/rest/api/content/139755535/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/139755535/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"148373535\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS16-J. Prevent XML Injection\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":2,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/148373535/label\"}}},\"extensions\":{\"position\":15},\"_links\":{\"webui\":\"/display/java/IDS16-J.+Prevent+XML+Injection\",\"tinyui\":\"/x/HwDYC\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/148373535\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/148373535/child\",\"history\":\"/rest/api/content/148373535/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/148373535/descendant\",\"space\":\"/rest/api/space/java\"}},{\"id\":\"148373539\",\"type\":\"page\",\"status\":\"current\",\"title\":\"IDS17-J. Prevent XML External Entity Attacks\",\"metadata\":{\"labels\":{\"results\":[{\"prefix\":\"global\",\"name\":\"ids\",\"id\":\"59080708\"},{\"prefix\":\"global\",\"name\":\"rule\",\"id\":\"1\"}],\"start\":0,\"limit\":200,\"size\":2,\"_links\":{\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/148373539/label\"}}},\"extensions\":{\"position\":16},\"_links\":{\"webui\":\"/display/java/IDS17-J.+Prevent+XML+External+Entity+Attacks\",\"tinyui\":\"/x/IwDYC\",\"self\":\"https://www.securecoding.cert.org/confluence/rest/api/content/148373539\"},\"_expandable\":{\"container\":\"\",\"operations\":\"\",\"children\":\"/rest/api/content/148373539/child\",\"history\":\"/rest/api/content/148373539/history\",\"ancestors\":\"\",\"body\":\"\",\"version\":\"\",\"descendants\":\"/rest/api/content/148373539/descendant\",\"space\":\"/rest/api/space/java\"}}]";

    JSONParser parser = new JSONParser();
    try {
      JSONArray goodArray = (JSONArray) parser.parse(goodResults);
      cppType.extractRulesFromChildPages(baseUrl, ids, goodArray);
      assertThat(cppType.getCodingStandardRules().length).isEqualTo(13);

      JSONArray dudArray = (JSONArray) parser.parse(dudResults);
      cppType.extractRulesFromChildPages(baseUrl, ids, dudArray);
      assertThat(cppType.getCodingStandardRules().length).isEqualTo(13);


    } catch (ParseException e) {
      e.printStackTrace();
    }

  }

  @Test
  public void testGetCertTypeStandardName() {

    Cert.CertType cppType = new Cert.CertType(Language.CPP, new String [] {"146440541"});

    assertThat(cppType.getStandardName()).isEqualTo(cert.getStandardName() + " " + cppType.getLanguage().getSq());

  }

}
